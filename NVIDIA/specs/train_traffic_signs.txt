model_config {
  architecture: "resnet18"
  pretrained_model_file: "/workspace/trafficcamnet/trafficcamnet.etlt"
  input_image_width: 960
  input_image_height: 544
  input_image_channels: 3
}

dataset_config {
  data_sources: {
    labeling_directory_path: "/workspace/dataset_kitti/train/labels"
    image_directory_path: "/workspace/dataset_kitti/train/images"
  }
  validation_data_sources: {
    labeling_directory_path: "/workspace/dataset_kitti/val/labels"
    image_directory_path: "/workspace/dataset_kitti/val/images"
  }

  target_class_mapping {
    key: "stop"
    value: "stop"
  }
  target_class_mapping {
    key: "yield"
    value: "yield"
  }
  target_class_mapping {
    key: "speed_limit"
    value: "speed_limit"
  }
  target_class_mapping {
    key: "no_entry"
    value: "no_entry"
  }
}

augmentation_config {
  spatial_augmentation {
    hflip_probability: 0.5
    zoom_min: 1.0
    zoom_max: 1.2
    max_rotate_degree: 7
    translate_max_x: 50
    translate_max_y: 30
  }

  color_augmentation {
    hue_rotation_max: 8.0
    saturation_shift_max: 0.1
    contrast_factor: 0.2
    brightness_shift_max: 0.2
  }
}

training_config {
  batch_size_per_gpu: 8
  num_epochs: 150
  enable_early_stopping: true

  early_stopping_config {
    patience: 15
    min_delta: 0.01
  }

  learning_rate: 0.001

  lr_scheduler {
    scheduler: "cosine"
    warmup_steps: 300
  }

  regularizer {
    type: L2
    weight: 0.0001
  }

  use_amp: true
}

bbox_rasterizer_config {
  target_class_config { class_name: "stop" }
  target_class_config { class_name: "yield" }
  target_class_config { class_name: "speed_limit" }
  target_class_config { class_name: "no_entry" }
}